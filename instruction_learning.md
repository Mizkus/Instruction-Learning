# Instruction Learning

Бородин Кирилл

## Постановка задачи

Современные эмбеддинговые модели позволяют получать плотные векторные
представления текста, оптимизированные под конкретную инструкцию
пользователя. Однако для каждой новой инструкции требуется пересчитывать
весь корпус текстов через большую трансформерную модель, что делает
процесс дорогим, медленным и плохо масштабируемым.

В рамках проекта ставится задача обучить лёгкое линейное (аффинное)
преобразование, которое будет переводить заранее вычисленные базовые
(неинструктированные) эмбеддинги текста в приближённые инструктированные
представления, соответствующие заданной задаче. Такой метод позволит
существенно уменьшить вычислительную стоимость и время обработки,
сохранив при этом качество, близкое к полному пересчёту крупной
инструктивной моделью.

## Формат входных и выходных данных

### Входные данные

1.  **Базовый эмбеддинг текста**
    -   полученный от универсальной модели *Qwen3-Embedding 0.6B*
    -   размерность: **1024**
2.  **Инструкция**
    -   напр. «определи тему новости», «определи географическое
        положение»
3.  **Целевой инструктированный эмбеддинг**
    -   полученный от *Qwen3-Embedding 0.6B*
    -   используется только в обучении как *teacher*

### Выходные данные

Эмбеддинг той же размерности, что и у целевой instruct-модели,
представляющий собой приближённую замену полного пересчёта текста через
instruct-encoder.

## Метрики

Основная метрика: **V-measure**, стандарт оценки качества кластеризации
текстов.\
Ожидаемое значение: отклонение **не более 10%** от исходного V-measure.

Дополнительная метрика: **ускорение** относительно полного пересчёта
через инструктивную модель.\
Цель --- значительный прирост в скорости при сохранении приемлемого
качества.

## Валидация

-   Train: **20%**
-   Test: **80%**
-   Seed фиксируется

## Данные

Используются следующие наборы данных:

### 1. **NYTClustering (New York Times Dataset)**

Используется для задач кластеризации новостей по семантическим
критериям: - **topic** (тема новости) - **location** (географическая
привязка события)

## Моделирование

### Бейзлайн

Полный пересчёт текстов с инструкцией через модель, обеспечивающую
максимально возможное качество кластеризации.\
Цель: получить сравнимое качество, но *значительно быстрее*.

### Основная модель

Один линейный слой размерности:\
**hidden_dim × hidden_dim**

## Внедрение

Результат проекта --- **Python‑пакет**, позволяющий быстро
преобразовывать базовые эмбеддинги в инструктированные без пересчёта
через полную модель.
